<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
  <title>Avery Analytics | Bookkeeping & Consulting</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

  <style>
    /* ---------- Global resets ----------*/
    *, *::before, *::after { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background-color: #f9f9f9;
      color: #111;
      -webkit-font-smoothing: antialiased;
      line-height: 1.6;
    }

    /* ---------- Header ----------*/
    header {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 0.25rem 0;   /* minimal whitespace */
      background: #fff;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
    }

    .logo {
      width: 250px;          /* keep same desktop size */
      max-width: 70vw;
      margin: 0;             /* no extra margin */
      display: block;
    }

    /* ---------- Typography ----------*/
    .cta {
      font-size: 1.125rem;
      color: #444;
      margin: 0.75em 0 0;
      text-align: center;
    }

    /* ---------- Sections ----------*/
    section {
      padding: 2em;
      max-width: 640px;
      margin: 1em auto 0 auto; /* reduced gap below logo */
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.04);
    }

    h2 {
      font-size: 1.5rem;
      margin-bottom: 0.5em;
      color: #222;
    }

    /* ---------- Form styles ----------*/
    form label    { display: block; font-weight: 600; margin: 1.2em 0 0.25em; }
    form input,
    form textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1rem;
      font-family: 'Inter', sans-serif;
    }

    .btn,
    form .btn {
      background-color: #000;
      color: #fff;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      margin-top: 1.5em;
      transition: background-color 0.3s;
    }
    form .btn:hover { background-color: #333; }
    form .btn-reset { background-color: #e0e0e0; color: #333; margin-left: 10px; }

    #confirmation-message { font-weight: 500; margin-top: 1.5em; }

    /* ---------- Appointment Booking ----------*/
    .appointment-button-container {
      margin: 1.5em 0;
      display: flex;
      justify-content: center;
      width: 100%;
    }
    
    .appointment-button-container > div {
      width: 100% !important;
      max-width: 300px;
    }
    
    /* Ensure Google Calendar button is responsive */
    .appointment-button-container button {
      width: 100% !important;
      max-width: 100% !important;
      height: auto !important;
      min-height: 48px;
      display: flex !important;
      align-items: center;
      justify-content: center;
      padding: 12px 16px !important;
      white-space: normal !important;
      line-height: 1.3 !important;
      font-size: 16px !important;
      text-align: center !important;
      overflow: hidden !important;
      text-overflow: ellipsis !important;
    }
    
    /* Fix for Instagram in-app browser */
    #book-appointment {
      padding-left: 10px;
      padding-right: 10px;
      width: 100%;
      max-width: 100%;
      box-sizing: border-box;
    }

    /* ---------- Footer ----------*/
    footer {
      text-align: center;
      padding: 2em 1em;
      font-size: 0.875rem;
      color: #777;
    }

    /* ---------- Small screens ----------*/
    @media (max-width: 480px) {
      .logo {
        width: 150px;      /* keep original mobile size */
        max-width: 80vw;
      }
      section {
        padding: 1.5em;
        margin-top: 1em;  /* reduced gap */
        margin-left: 1em;
        margin-right: 1em;
      }
      
      /* Mobile-friendly appointment button */
      .appointment-button-container button {
        font-size: 14px !important;
        padding: 10px 12px !important;
        min-width: 0 !important;
      }
      
      /* Instagram in-app browser and other very narrow viewports */
      @media (max-width: 360px) {
        section {
          padding: 1em;
          margin-left: 0.5em;
          margin-right: 0.5em;
        }
        
        .appointment-button-container > div {
          max-width: 100%;
        }
        
        .appointment-button-container button {
          padding: 8px 10px !important;
        }
      }
    }
  </style>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-NKJQXGX03F"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-NKJQXGX03F');
  </script>
</head>

<body>
  <header>
    <img src="assets/logo.png" alt="Avery Analytics Logo" class="logo">
  </header>

  <section>
    <h2>Our Approach</h2>
    <p>We specialize in helping blue‑collar and local service businesses create digital tools that bring in leads. Whether you're just starting or ready to scale, Avery Analytics builds simple, affordable systems that work.</p>
  </section>

  <section id="form">
    <h2>Tell Us About Your Business</h2>
    <form id="intake-form">
      <label for="name">Your Full Name</label>
      <input type="text" id="name" name="name" required>

      <label for="business">Business Name</label>
      <input type="text" id="business" name="business" required>

      <label for="email">Email Address</label>
      <input type="email" id="email" name="email" required>

      <label for="phone">Phone Number (XXX‑XXX‑XXXX)</label>
      <input type="text" id="phone" name="phone">

      <label for="website">Business Website (if any)</label>
      <input type="text" id="website" name="website">

      <label for="services">What services or products do you offer?</label>
      <textarea id="services" name="services" rows="3" required></textarea>

      <label for="challenges">What’s your biggest challenge right now?</label>
      <textarea id="challenges" name="challenges" rows="3"></textarea>

      <label for="goals">What are your goals for the next 6 months?</label>
      <textarea id="goals" name="goals" rows="3"></textarea>

      <label for="notes">Anything else you'd like me to know?</label>
      <textarea id="notes" name="notes" rows="3"></textarea>

      <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <button type="submit" class="btn">Submit</button>
        <button type="reset" class="btn btn-reset">Clear All</button>
      </div>

      <p id="confirmation-message" style="display:none; color: green;"></p>
    </form>
  </section>

  <footer>
    © 2025 Avery Analytics · Norfolk, VA · <a href="mailto:andrew@averyanalytics.net">Email Us</a>
  </footer>

  <!-- ---------- Form handler script ---------- -->
  <script>
    const form = document.getElementById("intake-form");
    const confirmationMessage = document.getElementById("confirmation-message");

    form.addEventListener("submit", async function (e) {
      e.preventDefault();
      const formData = new FormData(form);
      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbx5cAK8333mUro0NASlAF2z1lrJsWMiG0M0d3SWm8eRCqrvOzQM7oTpALjgiqI8OoLjOw/exec", {
          method: "POST",
          body: formData,
        });
        if (response.ok) {
          form.reset();
          confirmationMessage.textContent = "Thank you! We’ve received your information and will reach out shortly.";
          confirmationMessage.style.color = "green";
        } else {
          confirmationMessage.textContent = "Something went wrong. Please try again.";
          confirmationMessage.style.color = "red";
        }
      } catch (err) {
        confirmationMessage.textContent = "Submission failed. Please try again later.";
        confirmationMessage.style.color = "red";
      }
      confirmationMessage.style.display = "block";
    });
  </script>

  <!-- ---------- External assets ---------- -->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <script src="js/chatbot.js"></script>
  <script src="js/script.js"></script>

  <!-- Appointment Booking Section -->
  <section id="book-appointment">
    <h2>Schedule a Consultation</h2>
    <p>Ready to discuss your business needs? Book a free 30-minute consultation.</p>
    
    <div id="appointment-container" class="appointment-button-container">
      <!-- The appointment button will be loaded here -->
    </div>
  </section>

  <!-- Google Calendar Appointment Scheduling -->
  <link href="https://calendar.google.com/calendar/scheduling-button-script.css" rel="stylesheet">
  <script src="https://calendar.google.com/calendar/scheduling-button-script.js" async></script>
  <script>
    (function() {
      window.addEventListener('load', function() {
        // Check if we're in Instagram's in-app browser
        var isInstagram = /Instagram/.test(navigator.userAgent);
        var container = document.getElementById('appointment-container');
        var calendarUrl = 'https://calendar.google.com/calendar/appointments/schedules/AcZssZ1xXB2HVp_VenKz8MRi_oU7Fdxu5Xz_TiBmqeq6Qt_b6DRAjrWXPnr3bRqh9n560tfnew80uo23?gv=true';
        
        if (isInstagram) {
          // For Instagram users, create a custom button that opens in external browser
          var customButton = document.createElement('button');
          customButton.className = 'btn';
          customButton.innerHTML = 'Book an Appointment';
          customButton.style.width = '100%';
          customButton.style.maxWidth = '300px';
          customButton.style.margin = '0 auto';
          customButton.style.display = 'block';
          
          customButton.addEventListener('click', function(e) {
            e.preventDefault();
            // Open in external browser
            window.open(calendarUrl, '_blank');
          });
          
          // Clear container and add our custom button
          container.innerHTML = '';
          container.appendChild(customButton);
          
          // Add message below button
          var message = document.createElement('p');
          message.style.fontSize = '0.85em';
          message.style.color = '#666';
          message.style.textAlign = 'center';
          message.style.marginTop = '10px';
          message.innerHTML = '(Opens in your default browser for better experience)';
          container.appendChild(message);
        } else {
          // For non-Instagram users, load the normal calendar button
          calendar.schedulingButton.load({
            url: calendarUrl,
            color: '#000000',
            label: 'Book an Appointment',
            target: container,
          });
          
          // Function to adjust iframe and button for mobile
          function adjustForMobile() {
            var iframe = document.querySelector('#appointment-container iframe');
            var button = document.querySelector('#appointment-container button');
            
            if (iframe) {
              iframe.style.maxWidth = '100%';
              iframe.style.width = '100%';
              iframe.style.minHeight = '85px';
              iframe.style.border = 'none';
            }
            
            if (button) {
              // Apply special styling for smaller viewports
              if (window.innerWidth <= 400) {
                button.style.fontSize = '14px';
                button.style.padding = '8px 10px';
                button.style.width = '100%';
                
                // Adjust container as well
                var buttonContainer = document.querySelector('.appointment-button-container > div');
                if (buttonContainer) {
                  buttonContainer.style.maxWidth = '100%';
                }
              }
            }
          }
          
          // Initial adjustment after short delay to ensure button is loaded
          window.setTimeout(adjustForMobile, 1000);
          
          // Also adjust on resize events
          window.addEventListener('resize', adjustForMobile);
        }
      });
    })();
  </script>
</body>
</html>
